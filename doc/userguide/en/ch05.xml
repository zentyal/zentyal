<chapter id="ch-firewall">

	<title>Firewall</title>

	<section id='sect-fw-desc'>
		<title>Firewall in eBox</title>

		<para>
		  One of the most important features in eBox is its firewall
		  module. You can access it through
		  <menuchoice>
		    <guimenu>Firewall</guimenu>
		  </menuchoice>
		  . There you can make packet filtering (<xref
		  linkend='sect-fw-filter' />) or port
		  redirection (<xref linkend='sect-fw-redirects'/>).
		</para>

		<para>
                 The firewall has different behaviour depen with 
		external or inter
		<!--TODO: qué hace eBox con los interfaces externos-->
		</para>

                <para>
                 The internal interfaces are connected to local
                 networks. They had not restricitons as the
                 external interfaces have.
                </para>

                <para>
                The external interfaces are connected to external
                networks and eBox only allows redirects through them.
                However eBox modules can open ports normally.
               </para>

		<para>
		<!--TODO: qué tráficos se aplican para objetos y reglas-->
		</para>
		
		<para>
		<!--TODO: qué diferencias hay entre objetos y reglas-->
		</para>
	</section>

	<section id='sect-fw-redirects'>
		<!-- Firewall->Redirects -->
		<title>Port Redirects</title>

		<para>Port redirects allow to get external traffic
		into a host behind a eBox system with firewall module
		installed. You can get the configuration of these
		options at
		<menuchoice>
			<guimenu>Firewall</guimenu>
			<guimenuitem>Redirects</guimenuitem>
		</menuchoice>
		.
		</para>

		<para>
		If you need to add a new redirect, first select your
		desired <guilabel>Interface</guilabel> which will
		listen incoming connections. This should be one of the
		interfaces previously selected as external. Moreover,
		it should be assigned the <guilabel>External
		port</guilabel> where you expect your incoming
		traffic, and the <guilabel>protocol</guilabel> that
		will be used.</para>

		<para>You should enter the destination system
		<guilabel>IP address</guilabel> and its
		<guilabel>Port</guilabel> where packets would go
		on.</para>
	        
		<para>Once you have selected this data, you just need
		to select between the different
		<guilabel>Actions</guilabel>, the
		<guilabel>Add</guilabel> one, and click on it.</para>
				
		<para>To remove a rule, you should select remove
		between the available <guilabel>Actions</guilabel>,
		and click on it.</para>

		<para>Redirect configuration can be modified by
		changing its parameters and clicking on their modify
		<guilabel>Actions</guilabel>.</para>
	</section>

	<section id='sect-fw-filter'>
		<!-- Firewall->Packet Filter -->
		<title>Packet filter</title>

		<para>
		From
		<menuchoice>
			<guimenu>Firewall</guimenu>
			<guimenuitem>Packet filter</guimenuitem>
		</menuchoice>
		you can configure general packet filter rules or
		define them to each network object.
		</para>

		<para>At configuration window we can establish a deny
		policy for network packets. If you select this deny
		policy, it will be notified to the sender that the
		packet will be denied on destination. If you select an
		ignorance policy for network packets, they will be
		filtered and discarded without any notification.
		</para>

		<para>
		Making a click on Packet filer rules, you can access
		to a rule list for the eBox firewall. Each rule can be
		enabled or disabled without remove it. These rules,
		will be applied from top to bottom, so order could be
		important. On each rule, you can select its
		transmission protocol, which action to apply if a
		packet matches this rule (accept it or deny it),
		origin address and port and destination address and
		port. When specifying an address or a port, you can
		choose which ones belongs to the rule or which not, to
		enhance its flexibility and clearness of the rules,
		reducing the amount.
		</para>

		<para>
		Inside <guilabel>Default rules
		configuration</guilabel>, we can establish rules to be
		applied by default to each eBox object. This includes
		a general policy for the object, denying or accepting
		some services allowed to select from a list. It also
		includes the creation of a specific rules list for the
		object, which allow or deny connections with a
		protocol, a destination address (with a network mask)
		and certain ports. These rules can be enabled or
		disabled without removing them, as in eBox filtering rules</para>

		<para>
		At the bottom, we can choose an eBox network object
		from the selection list, and clicking on "Go", to
		apply the specified packet filtering rules. Between
		the selectable options for network objects we find:
		fix a specific policy or use a global policy,
		accepting or denying some services, from the Services
		selection list, and create rules for the object in the
		same way they are created for the global policy.
		</para>
	</section>

</chapter>
